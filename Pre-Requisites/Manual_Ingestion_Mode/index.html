



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://gitlab.delphix.com/mouhssine.saidi/mariadb_linux/Pre-Requisites/Manual_Ingestion_Mode/index.html">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../image/logo.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.2">
    
    
      
        <title>Manual Ingestion - Delphix MariaDB Plugin</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.ba0fd1a6.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica+Neue:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Helvetica Neue","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="none">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#manual-ingestion" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://gitlab.delphix.com/mouhssine.saidi/mariadb_linux" title="Delphix MariaDB Plugin" class="md-header-nav__button md-logo">
          
            <img src="../../image/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Delphix MariaDB Plugin
              </span>
              <span class="md-header-nav__topic">
                Manual Ingestion
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../image/logo.png" width="48" height="48">
      
    </span>
    Delphix MariaDB Plugin
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../index.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Pre Requisites
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Pre Requisites
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../General/index.html" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Replication_Mode/index.html" title="Replication" class="md-nav__link">
      Replication
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Manual Ingestion
      </label>
    
    <a href="index.html" title="Manual Ingestion" class="md-nav__link md-nav__link--active">
      Manual Ingestion
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-environment-requirements" title="Source Environment Requirements" class="md-nav__link">
    Source Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-db-user" title="Source DB User" class="md-nav__link">
    Source DB User
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-environment-requirements" title="Staging Environment Requirements" class="md-nav__link">
    Staging Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#staging-os-user" title="Staging OS User" class="md-nav__link">
    Staging OS User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage" title="Storage" class="md-nav__link">
    Storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mariadb-version-configuration" title="MariaDB Version &amp; Configuration" class="md-nav__link">
    MariaDB Version &amp; Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-environment-requirements" title="Target Environment Requirements" class="md-nav__link">
    Target Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-os-user" title="Target OS User" class="md-nav__link">
    Target OS User
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#done-whats-next" title="Done, What's Next?" class="md-nav__link">
    Done, What's Next?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../PluginInstallation/index.html" title="Plugin Installation" class="md-nav__link">
      Plugin Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Discovery/index.html" title="Discovery" class="md-nav__link">
      Discovery
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Linking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Linking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linking/Replication_Mode/index.html" title="Replication" class="md-nav__link">
      Replication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Linking/Manual_Ingestion_Mode/index.html" title="Manual Ingestion" class="md-nav__link">
      Manual Ingestion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Provisioning/index.html" title="Provisioning" class="md-nav__link">
      Provisioning
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Release Notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Release Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Release_Notes/MariaDB_1.0.0/index.html" title="MariaDB Plugin 1.0.0" class="md-nav__link">
      MariaDB Plugin 1.0.0
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/ExitCodes/index.html" title="Plugin Exit Codes" class="md-nav__link">
      Plugin Exit Codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Troubleshooting/index.html" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#source-environment-requirements" title="Source Environment Requirements" class="md-nav__link">
    Source Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#source-db-user" title="Source DB User" class="md-nav__link">
    Source DB User
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#staging-environment-requirements" title="Staging Environment Requirements" class="md-nav__link">
    Staging Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#staging-os-user" title="Staging OS User" class="md-nav__link">
    Staging OS User
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#storage" title="Storage" class="md-nav__link">
    Storage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mariadb-version-configuration" title="MariaDB Version &amp; Configuration" class="md-nav__link">
    MariaDB Version &amp; Configuration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-environment-requirements" title="Target Environment Requirements" class="md-nav__link">
    Target Environment Requirements
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#target-os-user" title="Target OS User" class="md-nav__link">
    Target OS User
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#done-whats-next" title="Done, What's Next?" class="md-nav__link">
    Done, What's Next?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="manual-ingestion">Manual Ingestion<a class="headerlink" href="#manual-ingestion" title="Permanent link">&para;</a></h1>
<p>Given below are the pre-requisites for MariaDB virtualization when using Manual Ingestion mode.</p>
<h3 id="source-environment-requirements">Source Environment Requirements<a class="headerlink" href="#source-environment-requirements" title="Permanent link">&para;</a></h3>
<p>Source environment is where the source MariaDB databases are running.</p>
<h4 id="source-db-user">Source DB User<a class="headerlink" href="#source-db-user" title="Permanent link">&para;</a></h4>
<p>In Manual Ingestion mode, Delphix does not interact with the source database. 
Delphix creates a staging database and the backups are ingested manually by a customer user. </p>
<p>However, Delphix needs to be able to manage this staging database for snapshots and other time travel operations. 
Hence, we require a user with the following permissions on the staging database.</p>
<p><em>SELECT, SHUTDOWN, SUPER, RELOAD ,SHOW VIEW, EVENT, TRIGGER</em></p>
<p>There are 2 ways to achieve this</p>
<ol>
<li>Create this user on your source database so that when the backup is restored, this user is present in the staging db.</li>
<li>
<p>Create this user manually in the staging db. 
   In this case, the customer user must ensure that this user is always present in the staging db 
   and has the necessary privileges</p>
<p><div class="highlight"><pre><span></span><code>  mysql&gt;CREATE USER &#39;delphix_os&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;delphix_user_passwd&#39;;
</code></pre></div>
3. Grant the necessary privileges to the user.    </p>
<div class="highlight"><pre><span></span><code>mysql&gt; GRANT SELECT, SHUTDOWN, SUPER, RELOAD ,SHOW VIEW, EVENT, TRIGGER on *.* to &#39;delphix_os&#39;@&#39;localhost&#39;;
</code></pre></div>
<p>You can also grant more permissive privileges</p>
<div class="highlight"><pre><span></span><code>mysql&gt;GRANT ALL PRIVILEGES ON *.* TO &#39;user&#39;@&#39;%&#39;;
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember, Delphix uses this user to manage the Staging database.</p>
<p>With Option #1 above, it is recommended that a dedicated source db user is used for Delphix with the privileges mentioned above.</p>
</div>
</li>
</ol>
<h3 id="staging-environment-requirements">Staging Environment Requirements<a class="headerlink" href="#staging-environment-requirements" title="Permanent link">&para;</a></h3>
<h4 id="staging-os-user">Staging OS User<a class="headerlink" href="#staging-os-user" title="Permanent link">&para;</a></h4>
<p>This is a typical Delphix OS staging user.
Key requirements for this user are given below.</p>
<p>Please refer to Delphix Docs for more detailed requirements.</p>
<ul>
<li>
<p>A Delphix OS user with the elevated permissions to run <em>ps, mount, umount, mkdir, rmdir</em>
  commands without requiring a password</p>
<p><strong>Sample: /etc/sudoers</strong>
  <div class="highlight"><pre><span></span><code>Defaults:delphix_os !requiretty
delphix_os <span class="nv">ALL</span><span class="o">=</span>NOPASSWD: <span class="se">\ </span>
/bin/mount, /bin/umount, /bin/mkdir, /bin/rmdir, /bin/ps
</code></pre></div></p>
</li>
<li>
<p>Delphix OS user should be in the same primary and secondary groups as mysql user ( or the MariaDB binary owner )</p>
</li>
<li>Delphix OS user must have execute access on all files within MariaDB installation folder - Min permission level 775 recommended.</li>
</ul>
<h4 id="storage">Storage<a class="headerlink" href="#storage" title="Permanent link">&para;</a></h4>
<ul>
<li>Empty folder on staging host to hold delphix toolkit [ approximate 2GB free space ]</li>
</ul>
<h4 id="mariadb-version-configuration">MariaDB Version &amp; Configuration<a class="headerlink" href="#mariadb-version-configuration" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p>MariaDB Binary version must match the version on the source database(s)</p>
</li>
<li>
<p>Starter <em>my.cnf</em> file <strong>[Recommended]</strong></p>
<p>As every  organization's MariaDB configuration is different,
Delphix expects a starter <em>my.cnf</em> file to be present in Delphix Toolkit Directory when creating a staging database.</p>
<p>Delphix will use this <em>my.cnf</em> file and modify it as per the configuration provided during the the dsource creation process.</p>
<p>This is recommended to reduce the possibility of errors while restoring the backup from the source database.</p>
<p>if tnis file is not provided, Delphix will create a <em>my.cnf</em> file from scratch. </p>
</li>
</ul>
<h3 id="target-environment-requirements">Target Environment Requirements<a class="headerlink" href="#target-environment-requirements" title="Permanent link">&para;</a></h3>
<h4 id="target-os-user">Target OS User<a class="headerlink" href="#target-os-user" title="Permanent link">&para;</a></h4>
<p>This is a typical Delphix OS target user.
Key requirements for this user are given below.</p>
<p>Please refer to Delphix Docs for more detailed requirements.</p>
<ul>
<li>
<p>A Delphix OS user with the elevated permissions to run <em>ps, mount, umount, mkdir, rmdir</em>
  commands without requiring a password</p>
<p><strong>Sample: /etc/sudoers</strong>
  <div class="highlight"><pre><span></span><code>Defaults:delphix_os !requiretty
delphix_os <span class="nv">ALL</span><span class="o">=</span>NOPASSWD: <span class="se">\ </span>
/bin/mount, /bin/umount, /bin/mkdir, /bin/rmdir, /bin/ps
</code></pre></div></p>
</li>
<li>
<p>Delphix OS user should be in the same primary and secondary groups as mysql user ( or the MariaDB binary owner )</p>
</li>
<li>Delphix OS user must have execute access on all files within MariaDB installation folder - Min permission level 775 recommended.</li>
</ul>
<h2 id="done-whats-next">Done, What's Next?<a class="headerlink" href="#done-whats-next" title="Permanent link">&para;</a></h2>
<p>Alright, we've taken care of all the pre-requisites. Next step - Install the plugin.   </p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Replication_Mode/index.html" title="Replication" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Replication
              </span>
            </div>
          </a>
        
        
          <a href="../../PluginInstallation/index.html" title="Plugin Installation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Plugin Installation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Delphix Corp.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://www.delphix.com/" class="md-footer-social__link fa fa-sitemap"></a>
    
      <a href="https://www.facebook.com/DelphixCorp/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/delphix" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/delphix" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://github.com/delphix" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-35429885-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>